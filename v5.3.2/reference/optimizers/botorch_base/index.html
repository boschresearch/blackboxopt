
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Various blackbox optimization algorithms with a common interface.">
      
      
      
        <link rel="canonical" href="https://boschresearch.github.io/blackboxopt/v5.3.2/reference/optimizers/botorch_base/">
      
      
        <link rel="prev" href="../bohb/">
      
      
        <link rel="next" href="../botorch_utils/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Botorch base - Blackbox Optimization</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#blackboxopt.optimizers.botorch_base" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Blackbox Optimization" class="md-header__button md-logo" aria-label="Blackbox Optimization" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Blackbox Optimization
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Botorch base
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/boschresearch/blackboxopt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    boschresearch/blackboxopt
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Blackbox Optimization" class="md-nav__button md-logo" aria-label="Blackbox Optimization" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Blackbox Optimization
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/boschresearch/blackboxopt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    boschresearch/blackboxopt
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/dask-distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dask Distributed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/multi-objective-multi-param/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mixed Space &amp; Multi Objective
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Optimizers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/space-filling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Space Filling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bohb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BOHB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/botorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reference Tests
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimization Loops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Optimization Loops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimization-loops/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimization-loops/sequential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimization-loops/dask-distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dask Distributed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimization-loops/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reference Tests
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimization loops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Optimization loops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization_loops/dask_distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dask distributed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization_loops/file_based_distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File based distributed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization_loops/sequential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization_loops/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization_loops/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" checked>
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Optimizers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bohb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bohb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Botorch base
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Botorch base
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base" class="md-nav__link">
    <span class="md-ellipsis">
      blackboxopt.optimizers.botorch_base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer" class="md-nav__link">
    <span class="md-ellipsis">
      SingleObjectiveBOTorchOptimizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SingleObjectiveBOTorchOptimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.generate_evaluation_specification" class="md-nav__link">
    <span class="md-ellipsis">
      generate_evaluation_specification()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.predict_model_based_best" class="md-nav__link">
    <span class="md-ellipsis">
      predict_model_based_best()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.report" class="md-nav__link">
    <span class="md-ellipsis">
      report()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../botorch_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Botorch utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hyperband/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hyperband
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../random_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Random search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../space_filling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Space filling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_8" >
        
          
          <label class="md-nav__link" for="__nav_5_7_8" id="__nav_5_7_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Staged
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_8">
            <span class="md-nav__icon md-icon"></span>
            Staged
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staged/bohb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bohb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staged/configuration_sampler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration sampler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staged/hyperband/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hyperband
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staged/iteration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iteration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staged/optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staged/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Visualizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/visualizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base" class="md-nav__link">
    <span class="md-ellipsis">
      blackboxopt.optimizers.botorch_base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer" class="md-nav__link">
    <span class="md-ellipsis">
      SingleObjectiveBOTorchOptimizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SingleObjectiveBOTorchOptimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.generate_evaluation_specification" class="md-nav__link">
    <span class="md-ellipsis">
      generate_evaluation_specification()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.predict_model_based_best" class="md-nav__link">
    <span class="md-ellipsis">
      predict_model_based_best()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.report" class="md-nav__link">
    <span class="md-ellipsis">
      report()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Botorch base</h1>

<div class="doc doc-object doc-module">

<a id="blackboxopt.optimizers.botorch_base"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer" class="doc doc-heading">
        <code>
SingleObjectiveBOTorchOptimizer            (<a class="autorefs autorefs-internal" title="blackboxopt.base.SingleObjectiveOptimizer" href="../../base/#blackboxopt.base.SingleObjectiveOptimizer">SingleObjectiveOptimizer</a>)
        </code>



</h2>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>blackboxopt/optimizers/botorch_base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SingleObjectiveBOTorchOptimizer</span><span class="p">(</span><span class="n">SingleObjectiveOptimizer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">search_space</span><span class="p">:</span> <span class="n">ps</span><span class="o">.</span><span class="n">ParameterSpace</span><span class="p">,</span>
        <span class="n">objective</span><span class="p">:</span> <span class="n">Objective</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
        <span class="n">acquisition_function_factory</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Model</span><span class="p">],</span> <span class="n">AcquisitionFunction</span><span class="p">],</span>
        <span class="n">af_optimizer_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">num_initial_random_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">max_pending_evaluations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">batch_shape</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">(),</span>
        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">torch_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Single objective BO optimizer that uses as a surrogate model the `model`</span>
<span class="sd">        object provided by user.</span>

<span class="sd">        The `model` is expected to be extended from BoTorch base model `Model` class,</span>
<span class="sd">        and does not require to be a GP model.</span>

<span class="sd">        Args:</span>
<span class="sd">            search_space: The space in which to optimize.</span>
<span class="sd">            objective: The objective to optimize.</span>
<span class="sd">            model: Surrogate model of `Model` type.</span>
<span class="sd">            acquisition_function_factory: Callable that produces an acquisition function</span>
<span class="sd">                instance, could also be a compatible acquisition function class.</span>
<span class="sd">                Only acquisition functions to be minimized are supported.</span>
<span class="sd">                Providing a partially initialized class is possible with, e.g.</span>
<span class="sd">                `functools.partial(UpperConfidenceBound, beta=6.0, maximize=False)`.</span>
<span class="sd">            af_optimizer_kwargs: Settings for acquisition function optimizer,</span>
<span class="sd">                see `botorch.optim.optimize_acqf` and in case the whole search space</span>
<span class="sd">                is discrete: `botorch.optim.optimize_acqf_discrete`. The former can be</span>
<span class="sd">                enforced by providing `raw_samples` or `num_restarts`, the latter by</span>
<span class="sd">                providing `num_random_choices`.</span>
<span class="sd">            num_initial_random_samples: Size of the initial space-filling design that</span>
<span class="sd">                is used before starting BO. The points are sampled randomly in the</span>
<span class="sd">                search space. If no random sampling is required, set it to 0.</span>
<span class="sd">                When random sampling is enabled, but evaluations with missing objective</span>
<span class="sd">                values are reported, more specifications are sampled until</span>
<span class="sd">                `num_initial_random_samples` many valid evaluations were reported.</span>
<span class="sd">            max_pending_evaluations: Maximum number of parallel evaluations. For</span>
<span class="sd">                sequential BO use the default value of 1. If no limit is required,</span>
<span class="sd">                set it to None.</span>
<span class="sd">            batch_shape: Batch dimension(s) used for batched models.</span>
<span class="sd">            logger: Custom logger.</span>
<span class="sd">            seed: A seed to make the optimization reproducible.</span>
<span class="sd">            torch_dtype: Torch data type used for storing the data. This needs to match</span>
<span class="sd">                the dtype of the model used</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">search_space</span><span class="o">=</span><span class="n">search_space</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="n">objective</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_initial_random</span> <span class="o">=</span> <span class="n">num_initial_random_samples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pending_evaluations</span> <span class="o">=</span> <span class="n">max_pending_evaluations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span> <span class="o">=</span> <span class="n">batch_shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span> <span class="ow">or</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;blackboxopt&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span> <span class="o">=</span> <span class="n">torch_dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
            <span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">search_space</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch_dtype</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">losses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch_dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">EvaluationSpecification</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_function_factory</span> <span class="o">=</span> <span class="n">acquisition_function_factory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">af_optimizer_kwargs</span> <span class="o">=</span> <span class="n">af_optimizer_kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_fantasy_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create model with the pending specifications and model based</span>
<span class="sd">        outcomes added to the training data.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">:</span>
            <span class="c1"># nothing to do when there are no pending specs</span>
            <span class="k">return</span> <span class="n">model</span>

        <span class="n">pending_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="o">.</span><span class="n">to_numerical</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">configuration</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="p">]</span>
            <span class="p">),</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fantasize</span><span class="p">(</span><span class="n">pending_X</span><span class="p">,</span> <span class="n">IIDNormalSampler</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">observation_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ExactGP</span><span class="p">):</span>
            <span class="c1"># ExactGP.fantasize extends model&#39;s X and Y with batch_size, even if</span>
            <span class="c1"># originally not given -&gt; need to reshape these to their original</span>
            <span class="c1"># representation</span>
            <span class="n">n_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train_targets</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">n_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">train_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train_inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">train_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train_targets</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_evaluation_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optimize acquisition on fantasy model to pick next point.&quot;&quot;&quot;</span>
        <span class="n">fantasy_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_fantasy_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="n">fantasy_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

        <span class="n">af</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_function_factory</span><span class="p">(</span><span class="n">fantasy_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">af</span><span class="p">,</span> <span class="s2">&quot;maximize&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Only acquisition functions that need to be minimized are supported. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;The given </span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> has maximize=True. &quot;</span>
                <span class="s2">&quot;One potential fix is using functools.partial(&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">af</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, maximize=False) as the &quot;</span>
                <span class="s2">&quot;acquisition_function_factory init argument.&quot;</span>
            <span class="p">)</span>

        <span class="n">acquisition_function_optimizer</span> <span class="o">=</span> <span class="n">_acquisition_function_optimizer_factory</span><span class="p">(</span>
            <span class="n">search_space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">,</span>
            <span class="n">af_opt_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">af_optimizer_kwargs</span><span class="p">,</span>
            <span class="n">torch_dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">configuration</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">acquisition_function_optimizer</span><span class="p">(</span><span class="n">af</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">EvaluationSpecification</span><span class="p">(</span>
            <span class="n">configuration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="o">.</span><span class="n">from_numerical</span><span class="p">(</span><span class="n">configuration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_evaluation_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationSpecification</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Call the optimizer specific function and append a unique integer id</span>
<span class="sd">        to the specification.</span>

<span class="sd">        Please refer to the docstring of</span>
<span class="sd">        `blackboxopt.base.SingleObjectiveOptimizer.generate_evaluation_specification`</span>
<span class="sd">        for a description of the method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_pending_evaluations</span>
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pending_evaluations</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">OptimizerNotReady</span>

        <span class="c1"># Generate random samples until there are enough samples where at least one of</span>
        <span class="c1"># the objective values is available</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_initial_random</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="nb">sum</span><span class="p">(</span><span class="o">~</span><span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">isnan</span><span class="p">(),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_initial_random</span>
        <span class="p">):</span>
            <span class="n">eval_spec</span> <span class="o">=</span> <span class="n">EvaluationSpecification</span><span class="p">(</span>
                <span class="n">configuration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span>
                <span class="n">optimizer_info</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;model_based_pick&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eval_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_evaluation_specification</span><span class="p">()</span>
            <span class="n">eval_spec</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">[</span><span class="s2">&quot;model_based_pick&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">eval_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">)</span>
        <span class="n">eval_spec</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">[</span><span class="s2">&quot;evaluation_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">[</span><span class="n">eval_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_spec</span>
        <span class="k">return</span> <span class="n">eval_spec</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_remove_pending_specifications</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]]</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find and remove the corresponding entries in `self.pending_specifications`.</span>

<span class="sd">        Args:</span>
<span class="sd">            evaluations: List of completed evaluations.</span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If an evaluation is reported with an ID that was not issued</span>
<span class="sd">            by the optimizer, the method will fail.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">evaluations</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">evaluations</span><span class="p">,</span> <span class="n">Evaluation</span><span class="p">)</span> <span class="k">else</span> <span class="n">evaluations</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">_evals</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;evaluation_id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;User provided EvaluationSpecification received.&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">[</span><span class="s2">&quot;evaluation_id&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Unknown evaluation_id reported. This could indicate that the &quot;</span>
                    <span class="s2">&quot;evaluation has been reported before!&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">[</span><span class="s2">&quot;evaluation_id&quot;</span><span class="p">]]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_append_evaluations_to_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]]</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the reported evaluation into its numerical representation</span>
<span class="sd">        and append it to the training data.</span>

<span class="sd">        Args:</span>
<span class="sd">            evaluations: List of completed evaluations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">evaluations</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">evaluations</span><span class="p">,</span> <span class="n">Evaluation</span><span class="p">)</span> <span class="k">else</span> <span class="n">evaluations</span>

        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">to_numerical</span><span class="p">(</span>
            <span class="n">_evals</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">,</span>
            <span class="n">objectives</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">],</span>
            <span class="n">batch_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span>
            <span class="n">torch_dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># fill in NaNs originating from inactive parameters (conditional spaces support)</span>
        <span class="c1"># botorch expect numerical representation of inputs to be within the unit</span>
        <span class="c1"># hypercube, thus we can&#39;t use the default c=-1.0</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">impute_nans_with_constant</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Next training configuration(s):</span><span class="si">{</span><span class="n">X</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">losses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">losses</span><span class="p">,</span> <span class="n">Y</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_internal_evaluation_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check validity of the evaluations and do optimizer agnostic bookkeeping.&quot;&quot;&quot;</span>
        <span class="n">call_functions_with_evaluations_and_collect_errors</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">validate_objectives</span><span class="p">,</span> <span class="n">objectives</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">]),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_remove_pending_specifications</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_append_evaluations_to_data</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">sort_evaluations</span><span class="p">(</span><span class="n">evaluations</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A simple report method that conditions the model on data.</span>
<span class="sd">        This likely needs to be overridden for more specific BO implementations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">evaluations</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">evaluations</span><span class="p">,</span> <span class="n">Evaluation</span><span class="p">)</span> <span class="k">else</span> <span class="n">evaluations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_internal_evaluation_data</span><span class="p">(</span><span class="n">_evals</span><span class="p">)</span>
        <span class="c1"># Just for populating all relevant caches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>

        <span class="n">x_filtered</span><span class="p">,</span> <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">filter_y_nans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">losses</span><span class="p">)</span>

        <span class="c1"># The actual model update</span>
        <span class="c1"># Ignore BotorchTensorDimensionWarning which is always reported to make the user</span>
        <span class="c1"># aware that they are reponsible for the right input Tensors dimensionality.</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">BotorchTensorDimensionWarning</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">condition_on_observations</span><span class="p">(</span><span class="n">x_filtered</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict_model_based_best</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current configuration that is estimated to be the best (in terms of</span>
<span class="sd">        optimal objective value) without waiting for a reported evaluation of that</span>
<span class="sd">        configuration. Instead, the objective value estimation relies on BO&#39;s</span>
<span class="sd">        underlying model.</span>

<span class="sd">        This might return `None` in case there is no successfully evaluated</span>
<span class="sd">        configuration yet (thus, the optimizer has not been given training data yet).</span>

<span class="sd">        Returns:</span>
<span class="sd">            blackboxopt.evaluation.Evaluation</span>
<span class="sd">                The evaluated specification containing the estimated best configuration</span>
<span class="sd">                or `None` in case no evaluations have been reported yet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">predict_model_based_best</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
            <span class="n">objective</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">,</span>
            <span class="n">search_space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">,</span>
            <span class="n">torch_dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_space</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">acquisition_function_factory</span><span class="p">,</span> <span class="n">af_optimizer_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_initial_random_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_pending_evaluations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_shape</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([]),</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Single objective BO optimizer that uses as a surrogate model the <code>model</code>
object provided by user.</p>
<p>The <code>model</code> is expected to be extended from BoTorch base model <code>Model</code> class,
and does not require to be a GP model.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>search_space</code></td>
        <td><code>ParameterSpace</code></td>
        <td><p>The space in which to optimize.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>objective</code></td>
        <td><code>Objective</code></td>
        <td><p>The objective to optimize.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>Model</code></td>
        <td><p>Surrogate model of <code>Model</code> type.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>acquisition_function_factory</code></td>
        <td><code>Callable[[botorch.models.model.Model], botorch.acquisition.acquisition.AcquisitionFunction]</code></td>
        <td><p>Callable that produces an acquisition function
instance, could also be a compatible acquisition function class.
Only acquisition functions to be minimized are supported.
Providing a partially initialized class is possible with, e.g.
<code>functools.partial(UpperConfidenceBound, beta=6.0, maximize=False)</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>af_optimizer_kwargs</code></td>
        <td></td>
        <td><p>Settings for acquisition function optimizer,
see <code>botorch.optim.optimize_acqf</code> and in case the whole search space
is discrete: <code>botorch.optim.optimize_acqf_discrete</code>. The former can be
enforced by providing <code>raw_samples</code> or <code>num_restarts</code>, the latter by
providing <code>num_random_choices</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_initial_random_samples</code></td>
        <td><code>int</code></td>
        <td><p>Size of the initial space-filling design that
is used before starting BO. The points are sampled randomly in the
search space. If no random sampling is required, set it to 0.
When random sampling is enabled, but evaluations with missing objective
values are reported, more specifications are sampled until
<code>num_initial_random_samples</code> many valid evaluations were reported.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>max_pending_evaluations</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Maximum number of parallel evaluations. For
sequential BO use the default value of 1. If no limit is required,
set it to None.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>batch_shape</code></td>
        <td><code>Size</code></td>
        <td><p>Batch dimension(s) used for batched models.</p></td>
        <td><code>torch.Size([])</code></td>
      </tr>
      <tr>
        <td><code>logger</code></td>
        <td><code>Optional[logging.Logger]</code></td>
        <td><p>Custom logger.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>A seed to make the optimization reproducible.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>torch_dtype</code></td>
        <td><code>dtype</code></td>
        <td><p>Torch data type used for storing the data. This needs to match
the dtype of the model used</p></td>
        <td><code>torch.float64</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>blackboxopt/optimizers/botorch_base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">ps</span><span class="o">.</span><span class="n">ParameterSpace</span><span class="p">,</span>
    <span class="n">objective</span><span class="p">:</span> <span class="n">Objective</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">acquisition_function_factory</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Model</span><span class="p">],</span> <span class="n">AcquisitionFunction</span><span class="p">],</span>
    <span class="n">af_optimizer_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">num_initial_random_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_pending_evaluations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">batch_shape</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">(),</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">torch_dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Single objective BO optimizer that uses as a surrogate model the `model`</span>
<span class="sd">    object provided by user.</span>

<span class="sd">    The `model` is expected to be extended from BoTorch base model `Model` class,</span>
<span class="sd">    and does not require to be a GP model.</span>

<span class="sd">    Args:</span>
<span class="sd">        search_space: The space in which to optimize.</span>
<span class="sd">        objective: The objective to optimize.</span>
<span class="sd">        model: Surrogate model of `Model` type.</span>
<span class="sd">        acquisition_function_factory: Callable that produces an acquisition function</span>
<span class="sd">            instance, could also be a compatible acquisition function class.</span>
<span class="sd">            Only acquisition functions to be minimized are supported.</span>
<span class="sd">            Providing a partially initialized class is possible with, e.g.</span>
<span class="sd">            `functools.partial(UpperConfidenceBound, beta=6.0, maximize=False)`.</span>
<span class="sd">        af_optimizer_kwargs: Settings for acquisition function optimizer,</span>
<span class="sd">            see `botorch.optim.optimize_acqf` and in case the whole search space</span>
<span class="sd">            is discrete: `botorch.optim.optimize_acqf_discrete`. The former can be</span>
<span class="sd">            enforced by providing `raw_samples` or `num_restarts`, the latter by</span>
<span class="sd">            providing `num_random_choices`.</span>
<span class="sd">        num_initial_random_samples: Size of the initial space-filling design that</span>
<span class="sd">            is used before starting BO. The points are sampled randomly in the</span>
<span class="sd">            search space. If no random sampling is required, set it to 0.</span>
<span class="sd">            When random sampling is enabled, but evaluations with missing objective</span>
<span class="sd">            values are reported, more specifications are sampled until</span>
<span class="sd">            `num_initial_random_samples` many valid evaluations were reported.</span>
<span class="sd">        max_pending_evaluations: Maximum number of parallel evaluations. For</span>
<span class="sd">            sequential BO use the default value of 1. If no limit is required,</span>
<span class="sd">            set it to None.</span>
<span class="sd">        batch_shape: Batch dimension(s) used for batched models.</span>
<span class="sd">        logger: Custom logger.</span>
<span class="sd">        seed: A seed to make the optimization reproducible.</span>
<span class="sd">        torch_dtype: Torch data type used for storing the data. This needs to match</span>
<span class="sd">            the dtype of the model used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">search_space</span><span class="o">=</span><span class="n">search_space</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="n">objective</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_initial_random</span> <span class="o">=</span> <span class="n">num_initial_random_samples</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_pending_evaluations</span> <span class="o">=</span> <span class="n">max_pending_evaluations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span> <span class="o">=</span> <span class="n">batch_shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span> <span class="ow">or</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;blackboxopt&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span> <span class="o">=</span> <span class="n">torch_dtype</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
        <span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">search_space</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch_dtype</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">losses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_shape</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch_dtype</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">EvaluationSpecification</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_function_factory</span> <span class="o">=</span> <span class="n">acquisition_function_factory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">af_optimizer_kwargs</span> <span class="o">=</span> <span class="n">af_optimizer_kwargs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.generate_evaluation_specification" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_evaluation_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Call the optimizer specific function and append a unique integer id
to the specification.</p>
<p>Please refer to the docstring of
<code>blackboxopt.base.SingleObjectiveOptimizer.generate_evaluation_specification</code>
for a description of the method.</p>

        <details class="quote">
          <summary>Source code in <code>blackboxopt/optimizers/botorch_base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_evaluation_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationSpecification</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Call the optimizer specific function and append a unique integer id</span>
<span class="sd">    to the specification.</span>

<span class="sd">    Please refer to the docstring of</span>
<span class="sd">    `blackboxopt.base.SingleObjectiveOptimizer.generate_evaluation_specification`</span>
<span class="sd">    for a description of the method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pending_evaluations</span>
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pending_evaluations</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">OptimizerNotReady</span>

    <span class="c1"># Generate random samples until there are enough samples where at least one of</span>
    <span class="c1"># the objective values is available</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_initial_random</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="nb">sum</span><span class="p">(</span><span class="o">~</span><span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">isnan</span><span class="p">(),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_initial_random</span>
    <span class="p">):</span>
        <span class="n">eval_spec</span> <span class="o">=</span> <span class="n">EvaluationSpecification</span><span class="p">(</span>
            <span class="n">configuration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span>
            <span class="n">optimizer_info</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;model_based_pick&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">eval_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_evaluation_specification</span><span class="p">()</span>
        <span class="n">eval_spec</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">[</span><span class="s2">&quot;model_based_pick&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">eval_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">)</span>
    <span class="n">eval_spec</span><span class="o">.</span><span class="n">optimizer_info</span><span class="p">[</span><span class="s2">&quot;evaluation_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pending_specifications</span><span class="p">[</span><span class="n">eval_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_spec</span>
    <span class="k">return</span> <span class="n">eval_spec</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.predict_model_based_best" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_model_based_best</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Get the current configuration that is estimated to be the best (in terms of
optimal objective value) without waiting for a reported evaluation of that
configuration. Instead, the objective value estimation relies on BO's
underlying model.</p>
<p>This might return <code>None</code> in case there is no successfully evaluated
configuration yet (thus, the optimizer has not been given training data yet).</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[blackboxopt.evaluation.Evaluation]</code></td>
      <td><p>blackboxopt.evaluation.Evaluation
    The evaluated specification containing the estimated best configuration
    or <code>None</code> in case no evaluations have been reported yet.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>blackboxopt/optimizers/botorch_base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict_model_based_best</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current configuration that is estimated to be the best (in terms of</span>
<span class="sd">    optimal objective value) without waiting for a reported evaluation of that</span>
<span class="sd">    configuration. Instead, the objective value estimation relies on BO&#39;s</span>
<span class="sd">    underlying model.</span>

<span class="sd">    This might return `None` in case there is no successfully evaluated</span>
<span class="sd">    configuration yet (thus, the optimizer has not been given training data yet).</span>

<span class="sd">    Returns:</span>
<span class="sd">        blackboxopt.evaluation.Evaluation</span>
<span class="sd">            The evaluated specification containing the estimated best configuration</span>
<span class="sd">            or `None` in case no evaluations have been reported yet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">predict_model_based_best</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
        <span class="n">objective</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective</span><span class="p">,</span>
        <span class="n">search_space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">,</span>
        <span class="n">torch_dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="blackboxopt.optimizers.botorch_base.SingleObjectiveBOTorchOptimizer.report" class="doc doc-heading">
<code class="highlight language-python"><span class="n">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>A simple report method that conditions the model on data.
This likely needs to be overridden for more specific BO implementations.</p>

        <details class="quote">
          <summary>Source code in <code>blackboxopt/optimizers/botorch_base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Evaluation</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple report method that conditions the model on data.</span>
<span class="sd">    This likely needs to be overridden for more specific BO implementations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">evaluations</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">evaluations</span><span class="p">,</span> <span class="n">Evaluation</span><span class="p">)</span> <span class="k">else</span> <span class="n">evaluations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_update_internal_evaluation_data</span><span class="p">(</span><span class="n">_evals</span><span class="p">)</span>
    <span class="c1"># Just for populating all relevant caches</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>

    <span class="n">x_filtered</span><span class="p">,</span> <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">filter_y_nans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">losses</span><span class="p">)</span>

    <span class="c1"># The actual model update</span>
    <span class="c1"># Ignore BotorchTensorDimensionWarning which is always reported to make the user</span>
    <span class="c1"># aware that they are reponsible for the right input Tensors dimensionality.</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">BotorchTensorDimensionWarning</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">condition_on_observations</span><span class="p">(</span><span class="n">x_filtered</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <center>
<p>Copyright (c) 2020 - for information on the respective copyright owner
see the NOTICE file and/or the
<a href=" https://github.com/boschresearch/blackboxopt">project repository</a>
</p>
<center>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>